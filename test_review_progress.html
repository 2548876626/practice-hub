<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµè§ˆå­¦ä¹ è¿›åº¦åˆ†ç¦»æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        .progress-display {
            background: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .quiz-type {
            background: #e3f2fd;
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            border-left: 4px solid #2196f3;
        }
        .success {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #0056b3;
        }
        .scroll-position {
            font-weight: bold;
            color: #28a745;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š æµè§ˆå­¦ä¹ è¿›åº¦åˆ†ç¦»æµ‹è¯•</h1>
        <p>æµ‹è¯•ä¸åŒé¢˜ç›®ç±»å‹çš„æµè§ˆå­¦ä¹ è¿›åº¦æ˜¯å¦ç‹¬ç«‹ä¿å­˜å’Œæ¢å¤</p>

        <!-- å½“å‰çŠ¶æ€æ˜¾ç¤º -->
        <div class="test-section">
            <h3>ğŸ“‹ å½“å‰çŠ¶æ€æ£€æŸ¥</h3>
            <button class="button" onclick="checkCurrentStates()">æ£€æŸ¥å½“å‰çŠ¶æ€</button>
            <div id="currentStates"></div>
        </div>

        <!-- æ¨¡æ‹Ÿè¿›åº¦è®¾ç½® -->
        <div class="test-section">
            <h3>ğŸ¯ æ¨¡æ‹Ÿè¿›åº¦è®¾ç½®</h3>
            <p>ä¸ºä¸åŒé¢˜ç›®ç±»å‹è®¾ç½®ä¸åŒçš„æµè§ˆè¿›åº¦ï¼Œæµ‹è¯•æ˜¯å¦èƒ½æ­£ç¡®åˆ†ç¦»</p>
            <button class="button" onclick="simulateProgress()">è®¾ç½®æ¨¡æ‹Ÿè¿›åº¦</button>
            <div id="simulationResult"></div>
        </div>

        <!-- è¿›åº¦éªŒè¯ -->
        <div class="test-section">
            <h3>âœ… è¿›åº¦éªŒè¯</h3>
            <button class="button" onclick="verifyProgress()">éªŒè¯è¿›åº¦åˆ†ç¦»</button>
            <div id="verificationResult"></div>
        </div>

        <!-- å®é™…æµ‹è¯•æŒ‡å— -->
        <div class="test-section">
            <h3>ğŸ§ª å®é™…æµ‹è¯•æŒ‡å—</h3>
            <div class="info">
                <h4>æµ‹è¯•æ­¥éª¤ï¼š</h4>
                <ol>
                    <li>æ‰“å¼€ä¸»åº”ç”¨ï¼Œé€‰æ‹©"ä¾›é…ç”µé€‰æ‹©é¢˜"</li>
                    <li>åˆ‡æ¢åˆ°"æµè§ˆå­¦ä¹ "æ¨¡å¼ï¼Œæ»šåŠ¨åˆ°æŸä¸ªä½ç½®</li>
                    <li>åˆ‡æ¢åˆ°"ä¾›é…ç”µåˆ¤æ–­é¢˜"ï¼Œæ»šåŠ¨åˆ°ä¸åŒä½ç½®</li>
                    <li>åˆ‡æ¢åˆ°"ä¾›é…ç”µå¡«ç©ºé¢˜"ï¼Œæ»šåŠ¨åˆ°å¦ä¸€ä¸ªä½ç½®</li>
                    <li>åˆ‡æ¢åˆ°"ä¾›é…ç”µè®¡ç®—é¢˜"ï¼Œæ»šåŠ¨åˆ°å…¶ä»–ä½ç½®</li>
                    <li>é‡æ–°åˆ‡æ¢å›ä¹‹å‰çš„é¢˜ç›®ç±»å‹ï¼Œæ£€æŸ¥æ˜¯å¦æ¢å¤åˆ°å¯¹åº”ä½ç½®</li>
                </ol>
            </div>
            <div class="success">
                <strong>é¢„æœŸç»“æœï¼š</strong>æ¯ç§é¢˜ç›®ç±»å‹éƒ½åº”è¯¥è®°ä½è‡ªå·±çš„æ»šåŠ¨ä½ç½®ï¼Œäº’ä¸å¹²æ‰°
            </div>
        </div>

        <!-- æŠ€æœ¯å®ç°è¯´æ˜ -->
        <div class="test-section">
            <h3>ğŸ’» æŠ€æœ¯å®ç°è¯´æ˜</h3>
            <div class="quiz-type">
                <h4>çŠ¶æ€ç»“æ„ï¼š</h4>
                <pre>states: {
    gongpeidian_choice: {
        reviewScrollPosition: 0,
        // å…¶ä»–çŠ¶æ€...
    },
    gongpeidian_judgment: {
        reviewScrollPosition: 0,
        // å…¶ä»–çŠ¶æ€...
    },
    gongpeidian_fill: {
        reviewScrollPosition: 0,
        // å…¶ä»–çŠ¶æ€...
    },
    gongpeidian_calculation: {
        reviewScrollPosition: 0,
        // å…¶ä»–çŠ¶æ€...
    }
}</pre>
            </div>
            <div class="quiz-type">
                <h4>å…³é”®åŠŸèƒ½ï¼š</h4>
                <ul>
                    <li><strong>ä¿å­˜è¿›åº¦</strong>ï¼šæ»šåŠ¨æ—¶å®æ—¶ä¿å­˜åˆ°å¯¹åº”é¢˜ç›®ç±»å‹çš„çŠ¶æ€ä¸­</li>
                    <li><strong>æ¢å¤è¿›åº¦</strong>ï¼šåˆ‡æ¢åˆ°æµè§ˆå­¦ä¹ æ¨¡å¼æ—¶æ¢å¤å¯¹åº”çš„æ»šåŠ¨ä½ç½®</li>
                    <li><strong>ç‹¬ç«‹å­˜å‚¨</strong>ï¼šæ¯ç§é¢˜ç›®ç±»å‹çš„è¿›åº¦å®Œå…¨ç‹¬ç«‹</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // æ£€æŸ¥å½“å‰çŠ¶æ€
        function checkCurrentStates() {
            const container = document.getElementById('currentStates');
            
            try {
                // æ£€æŸ¥ localStorage ä¸­çš„çŠ¶æ€
                const quizStates = localStorage.getItem('quiz_states');
                
                if (quizStates) {
                    const states = JSON.parse(quizStates);
                    let html = '<div class="progress-display">';
                    html += '<h4>ğŸ“Š å½“å‰ä¿å­˜çš„çŠ¶æ€ï¼š</h4>';
                    
                    Object.keys(states).forEach(type => {
                        const state = states[type];
                        const scrollPos = state.reviewScrollPosition || 0;
                        html += `<div class="quiz-type">`;
                        html += `<strong>${getTypeName(type)}</strong><br>`;
                        html += `æ»šåŠ¨ä½ç½®: <span class="scroll-position">${scrollPos}px</span><br>`;
                        html += `å½“å‰é¢˜ç›®: ${state.currentQuestionIndex || 0}<br>`;
                        html += `æ¨¡å¼: ${state.mode || 'sequential'}`;
                        html += `</div>`;
                    });
                    
                    html += '</div>';
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div class="info">æš‚æ— ä¿å­˜çš„çŠ¶æ€æ•°æ®</div>';
                }
            } catch (error) {
                container.innerHTML = `<div class="error">æ£€æŸ¥çŠ¶æ€å¤±è´¥: ${error.message}</div>`;
            }
        }

        // è·å–é¢˜ç›®ç±»å‹ä¸­æ–‡åç§°
        function getTypeName(type) {
            const names = {
                'gongpeidian_choice': 'ä¾›é…ç”µé€‰æ‹©é¢˜',
                'gongpeidian_judgment': 'ä¾›é…ç”µåˆ¤æ–­é¢˜',
                'gongpeidian_fill': 'ä¾›é…ç”µå¡«ç©ºé¢˜',
                'gongpeidian_calculation': 'ä¾›é…ç”µè®¡ç®—é¢˜'
            };
            return names[type] || type;
        }

        // æ¨¡æ‹Ÿè®¾ç½®ä¸åŒçš„è¿›åº¦
        function simulateProgress() {
            const container = document.getElementById('simulationResult');
            
            try {
                // åˆ›å»ºæ¨¡æ‹ŸçŠ¶æ€
                const mockStates = {
                    gongpeidian_choice: {
                        currentQuestionIndex: 0,
                        mode: 'sequential',
                        selectedAnswers: {},
                        questionOrder: [],
                        correctCount: 0,
                        answeredQuestions: [],
                        reviewScrollPosition: 500  // æ¨¡æ‹Ÿæ»šåŠ¨åˆ°500px
                    },
                    gongpeidian_judgment: {
                        currentQuestionIndex: 0,
                        mode: 'sequential',
                        selectedAnswers: {},
                        questionOrder: [],
                        correctCount: 0,
                        answeredQuestions: [],
                        reviewScrollPosition: 1200  // æ¨¡æ‹Ÿæ»šåŠ¨åˆ°1200px
                    },
                    gongpeidian_fill: {
                        currentQuestionIndex: 0,
                        mode: 'sequential',
                        selectedAnswers: {},
                        questionOrder: [],
                        correctCount: 0,
                        answeredQuestions: [],
                        reviewScrollPosition: 800   // æ¨¡æ‹Ÿæ»šåŠ¨åˆ°800px
                    },
                    gongpeidian_calculation: {
                        currentQuestionIndex: 0,
                        mode: 'sequential',
                        selectedAnswers: {},
                        questionOrder: [],
                        correctCount: 0,
                        answeredQuestions: [],
                        reviewScrollPosition: 1500  // æ¨¡æ‹Ÿæ»šåŠ¨åˆ°1500px
                    }
                };

                // ä¿å­˜åˆ° localStorage
                localStorage.setItem('quiz_states', JSON.stringify(mockStates));

                let html = '<div class="success">';
                html += '<h4>âœ… æ¨¡æ‹Ÿè¿›åº¦è®¾ç½®å®Œæˆï¼š</h4>';
                html += '<ul>';
                html += '<li>ä¾›é…ç”µé€‰æ‹©é¢˜ï¼šæ»šåŠ¨ä½ç½® 500px</li>';
                html += '<li>ä¾›é…ç”µåˆ¤æ–­é¢˜ï¼šæ»šåŠ¨ä½ç½® 1200px</li>';
                html += '<li>ä¾›é…ç”µå¡«ç©ºé¢˜ï¼šæ»šåŠ¨ä½ç½® 800px</li>';
                html += '<li>ä¾›é…ç”µè®¡ç®—é¢˜ï¼šæ»šåŠ¨ä½ç½® 1500px</li>';
                html += '</ul>';
                html += '</div>';

                container.innerHTML = html;
            } catch (error) {
                container.innerHTML = `<div class="error">è®¾ç½®æ¨¡æ‹Ÿè¿›åº¦å¤±è´¥: ${error.message}</div>`;
            }
        }

        // éªŒè¯è¿›åº¦åˆ†ç¦»
        function verifyProgress() {
            const container = document.getElementById('verificationResult');
            
            try {
                const quizStates = localStorage.getItem('quiz_states');
                
                if (!quizStates) {
                    container.innerHTML = '<div class="info">è¯·å…ˆè®¾ç½®æ¨¡æ‹Ÿè¿›åº¦</div>';
                    return;
                }

                const states = JSON.parse(quizStates);
                const expectedPositions = {
                    'gongpeidian_choice': 500,
                    'gongpeidian_judgment': 1200,
                    'gongpeidian_fill': 800,
                    'gongpeidian_calculation': 1500
                };

                let html = '<div class="progress-display">';
                html += '<h4>ğŸ” è¿›åº¦åˆ†ç¦»éªŒè¯ç»“æœï¼š</h4>';

                let allCorrect = true;
                Object.keys(expectedPositions).forEach(type => {
                    const expected = expectedPositions[type];
                    const actual = states[type]?.reviewScrollPosition || 0;
                    const isCorrect = actual === expected;
                    
                    if (!isCorrect) allCorrect = false;

                    html += `<div class="quiz-type">`;
                    html += `<strong>${getTypeName(type)}</strong><br>`;
                    html += `é¢„æœŸä½ç½®: ${expected}px<br>`;
                    html += `å®é™…ä½ç½®: <span class="scroll-position">${actual}px</span><br>`;
                    html += `çŠ¶æ€: ${isCorrect ? 'âœ… æ­£ç¡®' : 'âŒ é”™è¯¯'}`;
                    html += `</div>`;
                });

                html += '</div>';

                if (allCorrect) {
                    html += '<div class="success"><strong>ğŸ‰ éªŒè¯é€šè¿‡ï¼</strong>æ‰€æœ‰é¢˜ç›®ç±»å‹çš„è¿›åº¦éƒ½æ­£ç¡®åˆ†ç¦»ä¿å­˜</div>';
                } else {
                    html += '<div class="error"><strong>âŒ éªŒè¯å¤±è´¥ï¼</strong>è¿›åº¦åˆ†ç¦»å­˜åœ¨é—®é¢˜</div>';
                }

                container.innerHTML = html;
            } catch (error) {
                container.innerHTML = `<div class="error">éªŒè¯å¤±è´¥: ${error.message}</div>`;
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥çŠ¶æ€
        window.addEventListener('load', function() {
            checkCurrentStates();
            console.log('æµè§ˆå­¦ä¹ è¿›åº¦åˆ†ç¦»æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
        });
    </script>
</body>
</html>
